package com.Testutil;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class TestUtility {
	
	
//	public static   String TESTDATA_SHEET_PATH="C://Users//siva//Desktop//Venkat//com.Selenium//src//com//ExcelSheets//RegisterForm.xlsx";
	
	public static   Object[][] getTestdata(String Sheet1) throws IOException
	{
		 FileInputStream file = new FileInputStream("C:\\Users\\siva\\Desktop\\Venkat\\com.Selenium\\src\\com\\ExcelSheets\\Register.xlsx");
		  XSSFWorkbook workbook = new XSSFWorkbook(file);
			XSSFSheet sheet = workbook.getSheet(Sheet1);
			 
			//Line#17- You should use FileInputStream fileInput= new FileInputStream(new File(TestData_sheet_path));
			
			//Row r = sheet.getRow(i);
		//	Data[i][j] = r.getCell(j,r.CREATE_NULL_AS_BLANK).toString();
			
			
			int rowcount= sheet.getLastRowNum();
			int cellcount = sheet.getRow(0).getLastCellNum();
			 
			
			Object[][] data = new Object[rowcount][cellcount];
			
			
			for(int i=1;i<=rowcount;i++)
			{
				Row r = sheet.getRow(i);
				for (int j=0;j<=cellcount;j++)
					
				{
									
					//data[i][j] = sheet.getRow(i+1).getCell(j).toString();
					//Cell c = r.getCell(j,r.c)
					data [i] [j] = sheet.getRow(i+1).getCell(j).getStringCellValue();
				}
			}		
			
		 
			return data;
	}
}
